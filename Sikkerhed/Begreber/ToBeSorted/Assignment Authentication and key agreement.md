Assume the following scenario: A and B both have the knowledge of a secret key K (e.g., pre-shared). They communicate over an unsecure channel.

- ==a)== Define a protocol (by writing down a message sequence chart) in which A and B use the pre-shared key K to mutually authenticate each other and to agree on a common session key (different from the long-term pre-shared key K). Try to keep the number of exchanged messages as low as possible.
- ==b)== Discuss a man-in-the-middle attack for your protocol.
