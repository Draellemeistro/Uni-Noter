
> [!NOTE] What?
> Network scanning is the process of searching a network to identify active hosts, open ports, and other information about the devices or services on the network.
> 
> **Network scanning is a useful technique for both network administrators and security professionals.**

> [!NOTE] Why?
> **Network scanning can be performed for a variety of reasons, such as:** 
> - To better understand the devices and resources on a network 
> - To detect vulnerabilities 
> - To assess network security by identifying potential security risks.


> [!NOTE] Tools
> **[[Nmap]]** and **[[zenmap]]** are super tools
> - De-facto standard network scanner
> - [[Nmap]] → capable command line network scanning utility
> - [[zenmap]] → official Nmap Security Scanner GUI
> - [[Nmap]]/[[zenmap]] offer: 
> 	- Advanced techniques of mapping out networks: port scanning, OS detection, version detection, ping sweeps, etc. 
> 	- Can be used to scan large networks. 
> 	- Cross platform. 
> 	- Free / code available with license. 
> 	- Well documented and supported.

# What is Network scanning?
Network scanning is the **first phase** of an attack **to remotely locate, target**, and subsequently **exploit** vulnerable systems.
![[Pasted image 20240608184451.png]]
- Scanning is simple - send requests to other hosts, and see how they are responding
- How do you know which other hosts exists on your network?
- The simplest scan we can do – **[[Ping scanning]]**

## Two main categories: Active and Passive
### Active scanning

> [!quote] Active scanning
> **Directly interacting with the target host or network to gain information**
> 
> **==Example==: [[Nmap]]**

Active scanning is the process of identifying network services by transmitting certain packets known as the probe packets towards network hosts and devices and subsequently monitoring their responses.

### Passive scanning

> [!QUOTE] Passive scanning
> **Gathering information about the target without sending any packet to the target**
> 
> **==Example:== [[Wireshark]]**

Passive scanning identifies network services by observing traffic generated by servers and clients as it passes an observation point.

## More categories of Cyber scanning
![[Pasted image 20240608185113.png]]
#SecTodo 

# Different point of views
**Cyber Scanning Strategies**: Take into consideration the boundaries of a specific enterprise network and **define the direction** of the cyber scanning activity.
- Remote to Local
- Local to Remote
- Local to Local

## Which type of scanning to choose?

> [!question] Considerations
> - What type of information do you want/need? 
> - How much time do you have? 
> - How about resource usage?
> - Noise…

![[Pasted image 20240608190555.png]]
- **Scanning techniques**: 
	- -sS (TCP SYN scan) 
	- -sT (TCP connect() scan) 
	- -sU (UDP scans) 
	- -sA (TCP ACK scan) 
	- -sW (TCP Window scan) 
	- -sM (TCP Maimon scan)

### Network scans
- **Port Scan**: Identifies open ports on devices. 
	- **TCP scan** and **UDP scan** 
- **Vulnerability Scan**: Identifies known weaknesses (vulnerabilities) in software and operating systems. 
- **Asset Management Scan**: Discovers and identifies all devices connected to the network.
#### What is a port scan?
- It is a technique that involves sending series of network packets/connection attempts to different ports on a target.
- The results will uncover network or server status, which can be one of the following:
	-  **open**, 
	- **closed** 
	- **filtered**
1. **Open — Accepted** 
	- The target network/service is accepting datagrams/connections. 
	- The target network/service has responded with a TCP SYN packet to indicate that it’s listening 
	- The service utilized for the port scan is in use (usually UDP or TCP).
2. **Closed — Not Listening**
	- The target network/server has received the request, but no service is listening
3. **Filtered — Dropped/Blocked**
	- A request packet was sent. The host is not listening and does not respond. 
	- The request packet was likely blocked by a firewall or an intrusion prevention system

##### The standard open scan: TCP Connect scan
- Initiates a full connection with each target port using a three-way handshake (SYN, SYN-ACK, ACK).
	- When the port is closed, the target replies with a RST flag.
	- When the port is open, the target replies with an ACK flag.
##### Half open scan: TCP SYN Scan
- Sends only the initial SYN packet of the three-way handshake 
- Gather information about open ports without completing the TCP handshake process. When an open port is identified, the TCP handshake is reset before it can be completed. 
- **==It is stealthier than the Open-Scan method==**
![[Pasted image 20240608190738.png]]
##### Getting deeper with a version scan
![[Pasted image 20240608190758.png]]

##### SYN/ACK scan as an alternative…
- Instead of just sending a SYN flag, the source sends a SYN in addition to an ACK flag to the target. 
- For a closed port, the target will reply with a RST flag. 
- For an open port, it will not generate a response because the TCP protocol requires a sole SYN flag to initiate a connection. 
- Generates false positive
![[Pasted image 20240608190834.png]]

##### TCP Idle Scan (Zombie Scan)
- A more complex stealth technique that utilizes the previous **SYN|ACK scan** and the **Half-Open scan** 
- It is an indirect scan that uses a third-party host to probe the target and hide the source
![[Pasted image 20240608190915.png]]
#### A few examples
- Ping sweep useful to identify targets and to verify rogue hosts. 
	- Example: 
		-  – nmap -v -sP 192.168.100.0/24 
		- -sP ping scan.
- Port scanning useful to identify active ports (services or daemons) that are running on the targets
	- Example:
		- nmap -v -sT 192.168.100.x 
		- -sT normal scan 
		- -sS stealth scan
# The Internet Protocol Stack
![[Pasted image 20240608185720.png]]
## TCP vs UDP
![[Pasted image 20240608190227.png]]
### Transmission Control Protocol (TCP)
Provides **reliable**, **ordered**, and **error-checked** communication between two devices on a network
- **3-way handshake**
	- **SYN**: The client wants to establish a connection with a server, so it sends a segment with SYN(Synchronize Sequence Number) which informs the server that the client is likely to start communication and with what sequence number it starts segments with
	- **SYN + ACK**: Server responds to the client request with SYN-ACK signal bits set. Acknowledgement(ACK) signifies the response of the segment it received and SYN signifies with what sequence number it is likely to start the segments with
	- **ACK**: In the final part, client acknowledges the response of the server and they both establish a reliable connection with which they will start the actual data transfer
#### TCP packet

![[Pasted image 20240608190028.png]]
- **Source and destination port numbers**: Identify applications on sending and receiving devices. 
- **Sequence number**: Tracks the order of data segments within a stream. 
- **Acknowledgment number**: Confirms receipt of data segments. 
- **Flags**: Control connection establishment, data transmission, and termination. 
- **Window size**: Specifies the amount of data the receiver can buffer before needing an acknowledgment. 
- **Checksum**: Verifies data integrity to detect and correct transmission.

### User Datagram Protocol (UDP)
UDP is a **connectionless** protocol that provides **unreliable** data transfer.
#### UDP Packet Structure
- A UDP packet is a small data unit that encapsulates application data and additional information for routing and transmission. 
- The UDP packet header contains the following fields:
	- **Source port**: The port number of the sender application 
	- **Destination port**: The port number of the receiver application 
	- **Length**: The length of the UDP datagram 
	- **Checksum**: A checksum used to detect data corruption
![[Pasted image 20240608190204.png]]

